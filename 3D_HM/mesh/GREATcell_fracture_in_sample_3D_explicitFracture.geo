lc = 0.0075;
lc1 = 0.01;
lc2=0.001;
r0 = 0.097;//Outer egde of sample
r1 = 0.090;//Measuring location in sample
r2 = 0.065;//Inner ring in smaple
r3= 0.06; //fracture
segouter = 37;
segmid = 37;
seginner = 13;

//Note angle rotates anticlockwise, so use - to go clockwise
fracture_angle_to_bag1_sx = 0;

th = fracture_angle_to_bag1_sx*Pi/180;
sth = Sin(th);
cth = Cos(th);

p70x = r2;
p70y = 0;
p71x = 0;
p71y = r2;
p72x = -r2;
p72y = 0;
p73x = 0;
p73y = -r2;

Point(1)={0.0989400395497483,-0.0145213144685405,0,lc};
Point(2)={0.0989400395497483,0,0,lc};
Point(3)={0.0989400395497483,0.0145213144685405,0,lc};
Point(4)={0.0979528917494459,0.0194840415895657,0,lc};
Point(5)={0.0969657439491436,0.0244467687105909,0,lc};
Point(6)={0.0914086774858697,0.0378627139332354,0,lc};
Point(7)={0.0858516110225958,0.05127865915588,0,lc};
Point(8)={0.0830404519257676,0.0554858560599625,0,lc};
Point(9)={0.0802292928289395,0.0596930529640449,0,lc};
Point(10)={0.0699611728964922,0.0699611728964922,0,lc};
Point(11)={0.0596930529640449,0.0802292928289395,0,lc};
Point(12)={0.0554858560599625,0.0830404519257676,0,lc};
Point(13)={0.05127865915588,0.0858516110225958,0,lc};
Point(14)={0.0378627139332354,0.0914086774858697,0,lc};
Point(15)={0.0244467687105908,0.0969657439491436,0,lc};
Point(16)={0.0194840415895657,0.0979528917494459,0,lc};
Point(17)={0.0145213144685405,0.0989400395497483,0,lc};
Point(18)={6.93889390390723E-18,0.0989400395497483,0,lc};
Point(19)={-0.0145213144685405,0.0989400395497483,0,lc};
Point(20)={-0.0194840415895657,0.0979528917494459,0,lc};
Point(21)={-0.0244467687105908,0.0969657439491436,0,lc};
Point(22)={-0.0378627139332354,0.0914086774858697,0,lc};
Point(23)={-0.05127865915588,0.0858516110225958,0,lc};
Point(24)={-0.0554858560599625,0.0830404519257676,0,lc};
Point(25)={-0.0596930529640449,0.0802292928289395,0,lc};
Point(26)={-0.0699611728964922,0.0699611728964922,0,lc};
Point(27)={-0.0802292928289395,0.0596930529640449,0,lc};
Point(28)={-0.0830404519257677,0.0554858560599624,0,lc};
Point(29)={-0.0858516110225958,0.05127865915588,0,lc};
Point(30)={-0.0914086774858697,0.0378627139332354,0,lc};
Point(31)={-0.0969657439491436,0.0244467687105908,0,lc};
Point(32)={-0.0979528917494459,0.0194840415895657,0,lc};
Point(33)={-0.0989400395497483,0.0145213144685405,0,lc};
Point(34)={-0.0989400395497483,-9.54097911787244E-18,0,lc};
Point(35)={-0.0989400395497483,-0.0145213144685405,0,lc};
Point(36)={-0.0979528917494459,-0.0194840415895657,0,lc};
Point(37)={-0.0969657439491436,-0.0244467687105909,0,lc};
Point(38)={-0.0914086774858697,-0.0378627139332354,0,lc};
Point(39)={-0.0858516110225958,-0.05127865915588,0,lc};
Point(40)={-0.0830404519257676,-0.0554858560599625,0,lc};
Point(41)={-0.0802292928289395,-0.0596930529640449,0,lc};
Point(42)={-0.0699611728964922,-0.0699611728964922,0,lc};
Point(43)={-0.059693052964045,-0.0802292928289395,0,lc};
Point(44)={-0.0554858560599625,-0.0830404519257676,0,lc};
Point(45)={-0.05127865915588,-0.0858516110225958,0,lc};
Point(46)={-0.0378627139332354,-0.0914086774858697,0,lc};
Point(47)={-0.0244467687105908,-0.0969657439491436,0,lc};
Point(48)={-0.0194840415895657,-0.0979528917494459,0,lc};
Point(49)={-0.0145213144685405,-0.0989400395497483,0,lc};
Point(50)={2.60208521396521E-17,-0.0989400395497483,0,lc};
Point(51)={0.0145213144685405,-0.0989400395497483,0,lc};
Point(52)={0.0194840415895657,-0.0979528917494459,0,lc};
Point(53)={0.0244467687105909,-0.0969657439491436,0,lc};
Point(54)={0.0378627139332354,-0.0914086774858697,0,lc};
Point(55)={0.05127865915588,-0.0858516110225958,0,lc};
Point(56)={0.0554858560599625,-0.0830404519257676,0,lc};
Point(57)={0.0596930529640449,-0.0802292928289395,0,lc};
Point(58)={0.0699611728964922,-0.0699611728964922,0,lc};
Point(59)={0.0802292928289396,-0.0596930529640449,0,lc};
Point(60)={0.0830404519257677,-0.0554858560599624,0,lc};
Point(61)={0.0858516110225958,-0.0512786591558799,0,lc};
Point(62)={0.0914086774858697,-0.0378627139332354,0,lc};
Point(63)={0.0969657439491436,-0.0244467687105908,0,lc};
Point(64)={0.0979528917494459,-0.0194840415895657,0,lc};

Point(65) = { 0, 0, 0, lc2};
Point(66) = {r0, 0, 0, lc};
Point(67) = {0, r0, 0, lc};
Point(68) = {-r0, 0, 0, lc};
Point(69) = {0, -r0, 0, lc};



Point(70) = {r2, 0, 0, lc2};
Point(70000) = {r3, 0, 0, lc2};
Point(71) = {0., r2, 0, lc2};
Point(72) = {-r2, 0., 0, lc2};
Point(73) = {0, -r2, 0, lc2};

Point(74) = {r1, 0, 0, lc1};
Point(75) = {0, r1, 0, lc1};
Point(76) = {-r1, 0, 0, lc1};
Point(77) = {0, -r1, 0, lc1};

Circle(1) = {66, 65, 67};
Circle(2) = {66, 65, 69};
Circle(3) = {67, 65, 68};
Circle(4) = {68, 65, 69};

Line(5)={1,2};
Line(6)={2,3};
Line(7)={3,4};
Line(8)={4,5};
Line(9)={5,6};
Line(10)={6,7};
Line(11)={7,8};
Line(12)={8,9};
Line(13)={9,10};
Line(14)={10,11};
Line(15)={11,12};
Line(16)={12,13};
Line(17)={13,14};
Line(18)={14,15};
Line(19)={15,16};
Line(20)={16,17};
Line(21)={17,18};
Line(22)={18,19};
Line(23)={19,20};
Line(24)={20,21};
Line(25)={21,22};
Line(26)={22,23};
Line(27)={23,24};
Line(28)={24,25};
Line(29)={25,26};
Line(30)={26,27};
Line(31)={27,28};
Line(32)={28,29};
Line(33)={29,30};
Line(34)={30,31};
Line(35)={31,32};
Line(36)={32,33};
Line(37)={33,34};
Line(38)={34,35};
Line(39)={35,36};
Line(40)={36,37};
Line(41)={37,38};
Line(42)={38,39};
Line(43)={39,40};
Line(44)={40,41};
Line(45)={41,42};
Line(46)={42,43};
Line(47)={43,44};
Line(48)={44,45};
Line(49)={45,46};
Line(50)={46,47};
Line(51)={47,48};
Line(52)={48,49};
Line(53)={49,50};
Line(54)={50,51};
Line(55)={51,52};
Line(56)={52,53};
Line(57)={53,54};
Line(58)={54,55};
Line(59)={55,56};
Line(60)={56,57};
Line(61)={57,58};
Line(62)={58,59};
Line(63)={59,60};
Line(64)={60,61};
Line(65)={61,62};
Line(66)={62,63};
Line(67)={63,64};
Line(68)={64,1};

Circle(69) = {70, 65, 71};
Circle(70) = {70, 65, 73};
Circle(71) = {71, 65, 72};
Circle(72) = {72, 65, 73};

Circle(73) = {74, 65, 75};
Circle(74) = {74, 65, 77};
Circle(75) = {75, 65, 76};
Circle(76) = {76, 65, 77};

//Line(77) = {70,72};

Transfinite Line(1) = segouter Using Progression 1.0;//Outer
Transfinite Line(2) = segouter Using Progression 1.0;
Transfinite Line(3) = segouter Using Progression 1.0;
Transfinite Line(4) = segouter Using Progression 1.0;

Transfinite Line(69) = seginner Using Progression 1.0;//Inner
Transfinite Line(70) = seginner Using Progression 1.0;
Transfinite Line(71) = seginner Using Progression 1.0;
Transfinite Line(72) = seginner Using Progression 1.0;

Transfinite Line(73) = segmid Using Progression 1.0;//Mid
Transfinite Line(74) = segmid Using Progression 1.0;
Transfinite Line(75) = segmid Using Progression 1.0;
Transfinite Line(76) = segmid Using Progression 1.0;

Line Loop(1) = {69, 71, -77};
Line Loop(2) = {72, -70, 77};
Line Loop(3) = {1, 3, 4, -2};
Line Loop(4) = {5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68};
Line Loop(5) = {73, 75, 76, -74};


Line(77) = {65, 70000};


//+
Curve Loop(8) = {71, 72, -70, 69};
Curve Loop(6) = {78, 79, 80, 77};



Plane Surface(8) = {8};
Plane Surface(3) = {5,8};
Plane Surface(4) = {3,5};
Plane Surface(5) = {4,3};


Line{77} In Surface{8};


out1[]=Extrude {0, 0, 0.2} { Surface{1};Layers{20};};
out2[]=Extrude {0, 0, 0.2} { Surface{8};Layers{20};};
out3[]=Extrude {0, 0, 0.2} { Surface{3};Layers{20};};
out4[]=Extrude {0, 0, 0.2} { Surface{4};Layers{20};};
out5[]=Extrude {0, 0, 0.2} { Surface{5};Layers{20};};

lc_f = 0.005;
Point(100) = {0.0, 0.0, 0.06, lc_f};
Point(101) = {0.04, 0.0, 0.06, lc_f};
Point(102) = {0.04, 0.0, 0.16, lc_f};
Point(103) = {0.0, 0.0, 0.16, lc_f};
//+
Line(504) = {103, 102};
//+
Line(505) = {102, 101};
//+
Line(506) = {101, 100};
//+
Line(507) = {100, 103};
//+
Curve Loop(101) = {504, 505, 506, 507};
//+
Plane Surface(100) = {101};


//+
Line(508) = {70002, 103};
//+
Line(509) = {100, 65};

Surface{100} In Volume{1};
Line{508,508} In Volume{1};

//out6[]=Extrude {0, 0, 0.2} { Surface{6};Layers{20};};

Physical Volume(1) = {1, 2, 3, 4};
Physical Surface(2) = {100};

//Physical Volume(1) = {out1[1], out2[1], out3[1], out4[1]};
//Physical Volume(2) = {out5[1]};//+
//Transfinite Surface{6};




